{% extends 'layouts/base_app.html' %}

{% load safe_js %}
{% load static %}

{% block head %}
{{block.super}}
<link rel="stylesheet" href="{% static 'css/apexcharts.css' %}">

{% endblock head %}

{% block content %}
{{block.super}}
<div class="page-content container" id="content">
    <h1>Gr√°ficas y estadisticas</h1>

    <div class="row">
        <h2>Comportamiento del dolar</h2>
        <div class="col-12">
            <apexchart type=line height=350 :options="chartOptions" :series="series" />
        </div>
    </div>



</div>

{% endblock content %}


{% block javascript %}
{{block.super}}

<script src="{% static 'js/apexcharts/apexcharts.min.js' %}" ></script>
<script src="{% static 'js/apexcharts/vue-apexcharts.js' %}"></script>
<script src="{% static 'js/apexcharts/es_locale.js' %}" ></script>

<script type="text/javascript">

function buildTable(title, yaxis_title, first_date) {
    let charDefaultsOptions = {
        chart: {
            height: 350,
            locales: [apexchart_locale_es],
            defaultLocale: 'es',
            stacked: false,
            zoom: {
                enabled: true,
            },
            toolbar: {
                autoSelected: 'zoom'
            }
        },
        dataLabels: {
            enabled: true
        },
        stroke: {
            curve: 'straight'
        },
        title: {
            text: title,
            align: 'center'
        },
        grid: {
            row: {
                colors: ['#f3f3f3', 'transparent'], // takes an array which will be repeated on columns
                opacity: 0.5
            },
        },
        yaxis: {
            'title': {
                'text': yaxis_title
            },
            'min': 0,

        },
        xaxis: {
            type: 'datetime',
            min: new Date(first_date).getTime(),
            tickAmount: 6,
        },
        tooltip: {
            x: {
                format: 'dd MMMM yyyy'
            }
        }
    }
    return charDefaultsOptions;
}


var app = new Vue({
    delimiters: ['[[', ']]'],
    el: '#app',
    components: {
        apexchart: VueApexCharts,
    },
    data: function(){
        return {
            series: {{dolar_prices_series.series | safe }},
            chartOptions: buildTable(
                '{{ dolar_prices_series.title | safe }}',
                '{{ dolar_prices_series.yaxis_title | safe }}',
                '{{ dolar_prices_series.first_date | safe }}',
            ),
        }
    },
    methods: {
        
    },
})

</script>

{% endblock javascript %}